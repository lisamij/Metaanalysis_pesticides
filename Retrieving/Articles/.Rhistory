raw_data <- read_csv("243_formatted.csv")
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
library(tidyverse)
library(drc)
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2)
View(data)
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
filter(SE == 0) %>%
mutate (SE = SE + 0.01)
View(data)
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
if (SE == 0) %>%
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.01, SE))
View(data)
View(data)
# Creating datasets for each treatment
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment = treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
}
prop_24 <- single_data(data, "Propiconazole_24")
# Creating datasets for each treatment
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
}
prop_24 <- single_data(data, "Propiconazole_24")
View(prop_24)
# Creating datasets for each treatment
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
}
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
# Fit model with weights
prop_24_mod <- drm(Response_mean ~ Dose, data = prop_24, weights = SE, fct = LL.3())
# Plot
plot(prop_24_mod)
summary(prop_24_mod)
# Get EC50 with confidence interval
ED(prop_24_mod, respLev = c(50), level = 0.95)
# Fit model with weights
prop_24_mod <- drm(Response_mean ~ Dose, data = prop_24, weights = SE, fct = LL.3())
# Plot
plot(prop_24_mod)
#summary(prop_24_mod)
# Get EC50 with confidence interval
ED(prop_24_mod, respLev = c(50), level = 0.95)
# Fit model with weights
prop_24_mod <- drm(Response_percent ~ Dose, data = prop_24, weights = SE, fct = LL.3())
# Plot
plot(prop_24_mod)
#summary(prop_24_mod)
# Get EC50 with confidence interval
ED(prop_24_mod, respLev = c(50), level = 0.95)
# Fit model with weights
prop_24_mod <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3())
# Plot
plot(prop_24_mod)
#summary(prop_24_mod)
# Get EC50 with confidence interval
ED(prop_24_mod, respLev = c(50), level = 0.95)
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.01, SE)) %>%
mutate(Weight = (1/(SE^2)))
# Creating datasets for each treatment
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
}
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
View(prop_24)
View(data)
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.05, SE)) %>%
mutate(Weight = (1/(SE^2)))
# Creating datasets for each treatment
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
}
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
# Fit model with weights
prop_24_mod <- drm(Response_percent ~ Dose, data = prop_24, weights = Weight, fct = LL.3())
# Plot
plot(prop_24_mod)
#summary(prop_24_mod)
# Get EC50 with confidence interval
ED(prop_24_mod, respLev = c(50), level = 0.95)
View(prop_24)
# Fit model with weights
prop_24_mod <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3())
# Plot
plot(prop_24_mod)
#summary(prop_24_mod)
# Get EC50 with confidence interval
ED(prop_24_mod, respLev = c(50), level = 0.95)
# Fit model with weights
prop_24_mod <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3())
# Plot
plot(prop_24_mod)
#summary(prop_24_mod)
# Get EC50 with confidence interval
rep <- ED(prop_24_mod, respLev = c(50), level = 0.95)
# Fit model with weights
prop_24_mod <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3())
# Plot
plot(prop_24_mod)
#summary(prop_24_mod)
# Get EC50 with confidence interval
rep <- ED(prop_24_mod, respLev = c(50))
# Creating datasets for each treatment and modelling
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
model <- drm(Response_percent ~ Dose, data = df_mod, fct = LL.3())
plot(model)
Ec <- ED(mod, respLev = c(50))
return(Ec)
}
prop_24 <- single_data(data, "Propiconazole_24")
# Creating datasets for each treatment and modelling
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
model <- drm(Response_percent ~ Dose, data = df_mod, fct = LL.3())
plot(model)
Ec <- ED(model, respLev = c(50))
return(Ec)
}
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
ment_24 <- single_data(data, "Mentor_24")
ment_48 <- single_data(data, "Mentor_48")
propi_24 <- single_data(data, "PropiStar_24")
propi_48 <- single_data(data, "PropiStar_48")
metco_24 <- single_data(data, "Metconazole_24")
metco_48 <- single_data(data, "Metconazole_48")
quas_24 <- single_data(data, "Quash_24")
quas_48 <- single_data(data, "Quash_48")
cara_24 <- single_data(data, "Caramba_24")
cara_48 <- single_data(data, "Caramba_48")
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
ment_24 <- single_data(data, "Mentor_24")
ment_48 <- single_data(data, "Mentor_48")
# Creating datasets for each treatment and modelling
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
model <- drm(Response_percent ~ Dose, data = df_mod, fct = LL.3())
plot(model)
Ec <- ED(model, respLev = c(50))
return(Ec)
}
single_data_weighted <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
model <- drm(Response_percent ~ Dose, data = df_mod, weights = Weight, fct = LL.3())
plot(model)
Ec <- ED(model, respLev = c(50))
return(Ec)
}
ment_24 <- single_data_weighted(data, "Mentor_24")
ment_48 <- single_data_weighted(data, "Mentor_48")
ment_24 <- single_data(data, "Mentor_24")
ment_48 <- single_data(data, "Mentor_48")
propi_24 <- single_data(data, "PropiStar_24")
propi_48 <- single_data(data, "PropiStar_48")
quas_24 <- single_data(data, "Quash_24")
metco_24 <- single_data(data, "Metconazole_24")
metco_48 <- single_data(data, "Metconazole_48")
quas_24 <- single_data(data, "Quash_24")
quas_48 <- single_data(data, "Quash_48")
cara_24 <- single_data(data, "Caramba_24")
cara_48 <- single_data(data, "Caramba_48")
library(tidyverse)
library(drc)
setwd("C:/Users/lisam/OneDrive - University College London/Documents/Project/4_Full_text")
set.seed(42)
# Getting the data
raw_data <- read_csv("Articles/243_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.05, SE)) %>%
mutate(Weight = (1/(SE^2)))
# Creating datasets for each treatment and modelling
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
return(df_mod)
}
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
mod_prop_24 <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3())
plot(mod_prop_24)
ED(mod_prop_24, respLev = c(50))
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
mod_prop_24 <- drm(Response_percent ~ Dose, data = prop_24, weights = Weight, fct = LL.3())
plot(mod_prop_24)
ED(mod_prop_24, respLev = c(50))
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
mod_prop_24 <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3(), type = "binomial")
plot(mod_prop_24)
ED(mod_prop_24, respLev = c(50))
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
mod_prop_24 <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3(), type = "binomial")
plot(mod_prop_24)
ED(mod_prop_24, respLev = c(50), level = 0.95)
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
mod_prop_24 <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3())
plot(mod_prop_24)
ED(mod_prop_24, respLev = c(50), level = 0.95)
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
mod_prop_24 <- drm(Response_percent ~ Dose, data = prop_24, fct = LL.3())
plot(mod_prop_24)
ED(mod_prop_24, respLev = c(50))
# Creating datasets for each treatment and modelling
single_data <- function(df, treatment){
df_mod <- df %>%
filter(Treatment == treatment)
ref <- df_mod %>%
filter(Dose == 0) %>%
pull(Response_mean)
df_mod <- df_mod %>%
mutate(Response_percent = Response_mean/ref)
mod <- drm(Response_percent ~ Dose, data = df_mod, fct = LL.3())
plot(mod)
result <- ED(mod, respLev = c(50))
return(result)
}
prop_24 <- single_data(data, "Propiconazole_24")
prop_48 <- single_data(data, "Propiconazole_48")
# Getting the data
raw_data <- read_csv("Articles/487_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.05, SE)) %>%
mutate(Weight = (1/(SE^2)))
View(data)
# Getting the data
raw_data <- read_csv("Articles/487_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.05, SE)) %>%
mutate(Weight = (1/(SE^2)))
View(data)
mod_form <- drm(Response_percent ~ Dose, data = data[Treatment == "Formulation"], fct = LL.3())
# Getting the data
raw_data <- read_csv("Articles/487_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.05, SE)) %>%
mutate(Weight = (1/(SE^2)))
data_form <- data %>%
filter(Treatment == "Formulation")
mod_form <- drm(Response_percent ~ Dose, data = data_form, fct = LL.3())
mod_form <- drm(Response_mean ~ Dose, data = data_form, fct = LL.3())
plot(mod_form)
ED(mod_form, respLev = c(50))
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.3())
plot(mod_form)
ED(mod_form, respLev = c(50))
# Getting the data
raw_data <- read_csv("Articles/487_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.05, SE)) %>%
mutate(Weight = (1/(SE^2)))
data_form <- data %>%
filter(Treatment == "Formulation")
data_ai <- data %>%
filter(Treatment == "AI")
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, weights = Weight, fct = LL.3())
plot(mod_ai)
ED(mod_ai, respLev = c(50))
# Getting the data
raw_data <- read_csv("Articles/487_formatted.csv")
# Transforming the upper and lower bound into a CE, by getting the mean of the upper and lower
data <- raw_data %>%
mutate(SE = ((Response_mean - Response_SE_low) + (Response_SE_up - Response_mean))/2) %>%
# Modyifing so no SE = 0
mutate(SE = ifelse(SE == 0, SE + 0.05, SE)) %>%
mutate(Weight = (1/(SE^2)))
data_form <- data %>%
filter(Treatment == "Formulation")
data_ai <- data %>%
filter(Treatment == "AI")
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.3())
plot(mod_form)
ED(mod_form, respLev = c(50))
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, weights = Weight, fct = LL.3())
plot(mod_ai)
ED(mod_ai, respLev = c(50))
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, fct = LL.3())
plot(mod_ai)
ED(mod_ai, respLev = c(50))
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, weights = Weight, fct = LL.3())
plot(mod_ai)
ED(mod_ai, respLev = c(50))
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.4())
plot(mod_form)
ED(mod_form, respLev = c(50))
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, weights = Weight, fct = LL.4())
plot(mod_ai)
ED(mod_ai, respLev = c(50))
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.4())
plot(mod_form)
ED(mod_form, 50, interval = "delta")
mod_form <- drm(Response_mean ~ Dose, data = data_form, fct = LL.4())
plot(mod_form)
ED(mod_form, 50, interval = "delta")
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, fct = LL.4())
plot(mod_ai)
ED(mod_ai, respLev = c(50))
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, fct = LL.4())
plot(mod_ai)
ED(mod_ai, 50, interval = "delta")
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, weights = Weight, fct = LL.4())
plot(mod_ai)
ED(mod_ai, 50, interval = "delta")
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.4())
plot(mod_form)
ED(mod_form, 50, interval = "delta")
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.3())
plot(mod_form)
ED(mod_form, 50, interval = "delta")
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.3())
plot(mod_form)
ED(mod_form, 50)
mod_form <- drm(Response_mean ~ Dose, data = data_form, weights = Weight, fct = LL.3())
plot(mod_form)
ED(mod_form, 50)
mod_form <- drm(Response_mean ~ Dose, data = data_form, fct = LL.3())
plot(mod_form)
ED(mod_form, 50)
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, weights = Weight, fct = LL.3())
plot(mod_ai)
ED(mod_ai, 50)
mod_ai <- drm(Response_mean ~ Dose, data = data_ai, fct = LL.3())
plot(mod_ai)
ED(mod_ai, 50)
library(tidyverse)
library(drc)
setwd("C:/Users/lisam/OneDrive - University College London/Documents/Project/4_Full_text")
set.seed(42)
# Getting the data
raw_data <- read_csv("Articles/506.csv")
View(raw_data)
# Getting the data
raw_data <- read_csv("Articles/506.csv")
# Separating into severak datasets
tebpro <- raw_data %>%
filter(Treatment == "Mix_ai_teb_pro")%>%
drop_na(Response)
prod1 <- raw_data %>%
filter(Treatment == "Product_teb_pro")%>%
drop_na(Response)
pipcyp <- raw_data %>%
filter(Treatment == "Mix_ai_pip_cyp")%>%
drop_na(Response)
prod2 <- raw_data %>%
filter(Treatment == "Product_pip_cyp")%>%
drop_na(Response)
View(pipcyp)
# Fitting models
mod_tebpro <- drm(Response ~ Dose, data = tebpro, fct = LL.4())
plot(mod_tebpro)
ED(mod_tebpro, 50)
# Fitting models
mod_tebpro <- drm(Response ~ Dose, data = tebpro, fct = LL.3())
plot(mod_tebpro)
ED(mod_tebpro, 50)
# Fitting models
mod_tebpro <- drm(Response ~ Dose, data = tebpro, fct = LL.4())
plot(mod_tebpro)
ED(mod_tebpro, 50)
# Fitting models
mod_tebpro <- drm(Response ~ Dose, data = tebpro, fct = LL.4())
plot(mod_tebpro)
ED(mod_tebpro, 50)
mod_prod1 <- drm(Response ~ Dose, data = prod1, fct = LL.4())
plot(mod_prod1)
ED(mod_prod1, 50)
# Fitting models
mod_pipcyp <- drm(Response ~ Dose, data = pipcyp, fct = LL.4())
plot(mod_pipcyp)
ED(mod_pipcyp, 50)
mod_prod2 <- drm(Response ~ Dose, data = prod2, fct = LL.4())
plot(mod_prod2)
ED(mod_prod2, 50)
# Fitting models
mod_pipcyp <- drm(Response ~ Dose, data = pipcyp, fct = LL.4())
plot(mod_pipcyp)
ED(mod_pipcyp, 50)
mod_prod2 <- drm(Response ~ Dose, data = prod2, fct = LL.4())
plot(mod_prod2)
ED(mod_prod2, 50)
mod_prod2 <- drm(Response ~ Dose, data = prod2, fct = LL.3())
plot(mod_prod2)
ED(mod_prod2, 50)
library(tidyverse)
library(drc)
setwd("C:/Users/lisam/OneDrive - University College London/Documents/Project/4_Full_text")
set.seed(42)
# Getting the data
raw_data <- read_csv("Articles/624.csv")
View(raw_data)
mod <- drm(Response_mortality ~ Dose, data = raw_data, fct = LL.4())
plot(mod)
ED(mod, 50)
